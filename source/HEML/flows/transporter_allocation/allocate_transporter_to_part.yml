flows:
  allocate_transporter_to_part:
    description: Allocate transporter for one equipment part, checking availability then compatibility.
    steps:
      - collect: equipment_part_id
        description: "ID of the equipment part to transport"
        ask_before_filling: true

      - call: check_transporter_availability
        input:
          pickup_location_id: slots.pickup_location_id
        output: available_transporters

      - if: not slots.available_transporters
        then:
          - action: utter_no_available_transporters
            next: END

      - call: check_transporter_compatibility
        input:
          equipment_part_id: slots.equipment_part_id
          transporters: slots.available_transporters
        output: compatible_transporter

      - if: not slots.compatible_transporter
        then:
          - action: utter_no_compatible_transporter_found
            next: END

      - action: action_assign_transporter
        params:
          transporter_id: slots.compatible_transporter
          equipment_part_id: slots.equipment_part_id
        next:
          - if: slots.transporter_assigned
            then:
              - action: utter_transporter_assigned
                next: END
          - else:
              - action: utter_assignment_failed
                next: END
